"use strict";(self.webpackChunkdepositodwfront=self.webpackChunkdepositodwfront||[]).push([[832],{6655:(e,r,a)=>{a.r(r),a.d(r,{SalidaPage:()=>Oe});var o=a(5043),i=a(3003),n=a(6240),t=a(344),s=a(4150),l=a(6446),c=a(5865),d=a(1906),h=a(8903),p=a(794),u=a(7254),m=a(5342),g=a(8816);var x=a(9414),v=a(9824),b=a(8137),f=a(1088),j=a(4669),A=a(4056),y=a(8168),S=a(8587),C=a(8387),k=a(7954),O=a(8610),w=a(8092);const L=function(e){const{badgeContent:r,invisible:a=!1,max:o=99,showZero:i=!1}=e,n=(0,k.A)({badgeContent:r,max:o});let t=a;!1!==a||0!==r||i||(t=!0);const{badgeContent:s,max:l=o}=t?n:e;return{badgeContent:s,invisible:t,max:l,displayValue:s&&Number(s)>l?"".concat(l,"+"):s}};var R=a(4535),z=a(6431),T=a(6803),I=a(2532),_=a(2372);function P(e){return(0,_.Ay)("MuiBadge",e)}const N=(0,I.A)("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]);var W=a(579);const M=["anchorOrigin","className","classes","component","components","componentsProps","children","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],E=(0,R.Ay)("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,r)=>r.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),B=(0,R.Ay)("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.badge,r[a.variant],r["anchorOrigin".concat((0,T.A)(a.anchorOrigin.vertical)).concat((0,T.A)(a.anchorOrigin.horizontal)).concat((0,T.A)(a.overlap))],"default"!==a.color&&r["color".concat((0,T.A)(a.color))],a.invisible&&r.invisible]}})((e=>{let{theme:r}=e;var a;return{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:r.typography.fontFamily,fontWeight:r.typography.fontWeightMedium,fontSize:r.typography.pxToRem(12),minWidth:20,lineHeight:1,padding:"0 6px",height:20,borderRadius:10,zIndex:1,transition:r.transitions.create("transform",{easing:r.transitions.easing.easeInOut,duration:r.transitions.duration.enteringScreen}),variants:[...Object.keys((null!=(a=r.vars)?a:r).palette).filter((e=>{var a,o;return(null!=(a=r.vars)?a:r).palette[e].main&&(null!=(o=r.vars)?o:r).palette[e].contrastText})).map((e=>({props:{color:e},style:{backgroundColor:(r.vars||r).palette[e].main,color:(r.vars||r).palette[e].contrastText}}))),{props:{variant:"dot"},style:{borderRadius:4,height:8,minWidth:8,padding:0}},{props:e=>{let{ownerState:r}=e;return"top"===r.anchorOrigin.vertical&&"right"===r.anchorOrigin.horizontal&&"rectangular"===r.overlap},style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",["&.".concat(N.invisible)]:{transform:"scale(0) translate(50%, -50%)"}}},{props:e=>{let{ownerState:r}=e;return"bottom"===r.anchorOrigin.vertical&&"right"===r.anchorOrigin.horizontal&&"rectangular"===r.overlap},style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",["&.".concat(N.invisible)]:{transform:"scale(0) translate(50%, 50%)"}}},{props:e=>{let{ownerState:r}=e;return"top"===r.anchorOrigin.vertical&&"left"===r.anchorOrigin.horizontal&&"rectangular"===r.overlap},style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",["&.".concat(N.invisible)]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:e=>{let{ownerState:r}=e;return"bottom"===r.anchorOrigin.vertical&&"left"===r.anchorOrigin.horizontal&&"rectangular"===r.overlap},style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",["&.".concat(N.invisible)]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:e=>{let{ownerState:r}=e;return"top"===r.anchorOrigin.vertical&&"right"===r.anchorOrigin.horizontal&&"circular"===r.overlap},style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",["&.".concat(N.invisible)]:{transform:"scale(0) translate(50%, -50%)"}}},{props:e=>{let{ownerState:r}=e;return"bottom"===r.anchorOrigin.vertical&&"right"===r.anchorOrigin.horizontal&&"circular"===r.overlap},style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",["&.".concat(N.invisible)]:{transform:"scale(0) translate(50%, 50%)"}}},{props:e=>{let{ownerState:r}=e;return"top"===r.anchorOrigin.vertical&&"left"===r.anchorOrigin.horizontal&&"circular"===r.overlap},style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",["&.".concat(N.invisible)]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:e=>{let{ownerState:r}=e;return"bottom"===r.anchorOrigin.vertical&&"left"===r.anchorOrigin.horizontal&&"circular"===r.overlap},style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",["&.".concat(N.invisible)]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:r.transitions.create("transform",{easing:r.transitions.easing.easeInOut,duration:r.transitions.duration.leavingScreen})}}]}})),H=o.forwardRef((function(e,r){var a,o,i,n,t,s;const l=(0,z.b)({props:e,name:"MuiBadge"}),{anchorOrigin:c={vertical:"top",horizontal:"right"},className:d,component:h,components:p={},componentsProps:u={},children:m,overlap:g="rectangular",color:x="default",invisible:v=!1,max:b=99,badgeContent:f,slots:j,slotProps:A,showZero:R=!1,variant:I="standard"}=l,_=(0,S.A)(l,M),{badgeContent:N,invisible:H,max:D,displayValue:F}=L({max:b,invisible:v,badgeContent:f,showZero:R}),V=(0,k.A)({anchorOrigin:c,color:x,overlap:g,variant:I,badgeContent:f}),q=H||null==N&&"dot"!==I,{color:U=x,overlap:K=g,anchorOrigin:Z=c,variant:G=I}=q?V:l,X="dot"!==G?F:void 0,J=(0,y.A)({},l,{badgeContent:N,invisible:q,max:D,displayValue:X,showZero:R,anchorOrigin:Z,color:U,overlap:K,variant:G}),Q=(e=>{const{color:r,anchorOrigin:a,invisible:o,overlap:i,variant:n,classes:t={}}=e,s={root:["root"],badge:["badge",n,o&&"invisible","anchorOrigin".concat((0,T.A)(a.vertical)).concat((0,T.A)(a.horizontal)),"anchorOrigin".concat((0,T.A)(a.vertical)).concat((0,T.A)(a.horizontal)).concat((0,T.A)(i)),"overlap".concat((0,T.A)(i)),"default"!==r&&"color".concat((0,T.A)(r))]};return(0,O.A)(s,P,t)})(J),Y=null!=(a=null!=(o=null==j?void 0:j.root)?o:p.Root)?a:E,$=null!=(i=null!=(n=null==j?void 0:j.badge)?n:p.Badge)?i:B,ee=null!=(t=null==A?void 0:A.root)?t:u.root,re=null!=(s=null==A?void 0:A.badge)?s:u.badge,ae=(0,w.A)({elementType:Y,externalSlotProps:ee,externalForwardedProps:_,additionalProps:{ref:r,as:h},ownerState:J,className:(0,C.A)(null==ee?void 0:ee.className,Q.root,d)}),oe=(0,w.A)({elementType:$,externalSlotProps:re,ownerState:J,className:(0,C.A)(Q.badge,null==re?void 0:re.className)});return(0,W.jsxs)(Y,(0,y.A)({},ae,{children:[m,(0,W.jsx)($,(0,y.A)({},oe,{children:X}))]}))}));var D=a(1958),F=a(8422);const V=e=>{let{tabValue:r,onTabChange:a,salidasPendientesCount:o=0,salidasAprobadasCount:i=0,remitosCount:n=0}=e;return(0,W.jsxs)(j.A,{value:r,onChange:(e,r)=>{a(e,r)},"aria-label":"salida tabs",sx:{borderBottom:1,borderColor:"divider","& .MuiTab-root":{minHeight:48,textTransform:"none",fontSize:"0.875rem",fontWeight:500}},children:[(0,W.jsx)(A.A,{label:(0,W.jsx)(H,{badgeContent:n,color:"success",children:(0,W.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(F.A,{fontSize:"small"}),"Remito Salida"]})}),id:"salida-tab-0","aria-controls":"salida-tabpanel-0"}),(0,W.jsx)(A.A,{label:(0,W.jsx)(H,{badgeContent:o,color:"warning",children:(0,W.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(m.A,{fontSize:"small"}),"Salidas Pendientes"]})}),id:"salida-tab-1","aria-controls":"salida-tabpanel-1"}),(0,W.jsx)(A.A,{label:(0,W.jsx)(H,{badgeContent:i,color:"info",children:(0,W.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(D.A,{fontSize:"small"}),"Historial"]})}),id:"salida-tab-2","aria-controls":"salida-tabpanel-2"})]})},q="Salida creada exitosamente",U="Salida aprobada exitosamente",K="Salida rechazada",Z="Salida completada exitosamente",G="Error al crear la salida",X="Error al aprobar la salida",J="Error al rechazar la salida",Q="Error al completar la salida",Y={PENDIENTES:{title:"No hay salidas pendientes",description:"No hay solicitudes de salida pendientes de aprobaci\xf3n"},HISTORIAL:{title:"No hay historial de salidas",description:"No se encontraron registros de salidas en el historial"},REMITOS:{title:"No hay remitos de salida",description:"No se encontraron remitos de salida registrados"}},$=e=>{let{icon:r,title:a,description:o,searchTerm:i=""}=e;const n=i&&i.trim().length>0;return(0,W.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:4,textAlign:"center",minHeight:300},children:[r&&(0,W.jsx)(r,{sx:{fontSize:64,color:"#ccc",marginBottom:2}}),(0,W.jsx)(c.A,{variant:"h6",component:"h3",gutterBottom:!0,sx:{color:"#666",fontWeight:500},children:n?'No se encontraron salidas para "'.concat(i,'"'):a}),(0,W.jsx)(c.A,{variant:"body2",color:"textSecondary",sx:{maxWidth:400,lineHeight:1.5},children:n?"Intenta con otros t\xe9rminos de b\xfasqueda o verifica la ortograf\xeda.":o})]})};var ee=a(35),re=a(6600),ae=a(5316),oe=a(5795),ie=a(2143),ne=a(1637),te=a(9347),se=a(2410);const le=e=>{var r,a;let{open:n,onClose:t,onSubmit:s,loading:p=!1,selectedItem:u=null}=e;const m=(0,i.wA)(),[g,x]=(0,o.useState)({cliente:"",fecha:(new Date).toISOString().split("T")[0],kilos:"",unidades:"",partida:""}),[v,b]=(0,o.useState)({}),{proveedores:f,isLoading:j}=(0,i.d4)((e=>e.remitos));(0,o.useEffect)((()=>{!n||f&&0!==f.length||m((0,se.LC)())}),[n,m,f]),(0,o.useEffect)((()=>{u&&x((e=>({...e,kilos:u.kilos||"",unidades:u.unidades||"",partida:u.partida||""})))}),[u]);const A=(null===f||void 0===f?void 0:f.filter((e=>{var r;return null===(r=e.categoria)||void 0===r?void 0:r.toLowerCase().includes("cliente")})))||[],y=e=>r=>{const a=r.target.value;x((r=>({...r,[e]:a}))),v[e]&&b((r=>({...r,[e]:""})))},S=()=>{x({cliente:"",fecha:(new Date).toISOString().split("T")[0],kilos:"",unidades:"",partida:""}),b({}),t()};return(0,W.jsxs)(ee.A,{open:n,onClose:S,maxWidth:"sm",fullWidth:!0,children:[(0,W.jsx)(re.A,{children:"Agregar al Remito de Salida"}),(0,W.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{const e={};return g.cliente.trim()||(e.cliente="El cliente es requerido"),g.fecha||(e.fecha="La fecha es requerida"),g.kilos||g.unidades||(e.kilos="Debe especificar kilos o unidades"),g.kilos&&parseFloat(g.kilos)<=0&&(e.kilos="Los kilos deben ser mayores a 0"),g.unidades&&parseInt(g.unidades)<=0&&(e.unidades="Las unidades deben ser mayores a 0"),b(e),0===Object.keys(e).length})()&&s(g)},children:[(0,W.jsx)(ae.A,{children:(0,W.jsxs)(h.Ay,{container:!0,spacing:2,children:[(0,W.jsx)(h.Ay,{item:!0,xs:12,children:(0,W.jsx)(oe.A,{select:!0,fullWidth:!0,label:"Cliente",value:g.cliente,onChange:y("cliente"),error:!!v.cliente,helperText:v.cliente,disabled:j,children:j?(0,W.jsxs)(ie.A,{disabled:!0,children:[(0,W.jsx)(ne.A,{size:20,sx:{mr:1}}),"Cargando clientes..."]}):0===A.length?(0,W.jsx)(ie.A,{disabled:!0,children:"No hay clientes disponibles"}):A.map((e=>(0,W.jsx)(ie.A,{value:e.id,children:e.nombre},e.id)))})}),(0,W.jsx)(h.Ay,{item:!0,xs:12,children:(0,W.jsx)(oe.A,{fullWidth:!0,type:"date",label:"Fecha de Salida",value:g.fecha,onChange:y("fecha"),error:!!v.fecha,helperText:v.fecha,InputLabelProps:{shrink:!0}})}),(0,W.jsx)(h.Ay,{item:!0,xs:6,children:(0,W.jsx)(oe.A,{fullWidth:!0,type:"number",label:"Kilos",value:g.kilos,onChange:y("kilos"),error:!!v.kilos,helperText:v.kilos,placeholder:"0.00",inputProps:{step:"0.01",min:"0"}})}),(0,W.jsx)(h.Ay,{item:!0,xs:6,children:(0,W.jsx)(oe.A,{fullWidth:!0,type:"number",label:"Unidades",value:g.unidades,onChange:y("unidades"),error:!!v.unidades,helperText:v.unidades,placeholder:"0",inputProps:{min:"0"}})}),u&&(0,W.jsx)(h.Ay,{item:!0,xs:12,children:(0,W.jsxs)(l.A,{sx:{p:2,bgcolor:"grey.50",borderRadius:1,border:"1px solid",borderColor:"grey.300"},children:[(0,W.jsx)(c.A,{variant:"subtitle2",gutterBottom:!0,children:"Material seleccionado:"}),(0,W.jsxs)(c.A,{variant:"body2",color:"textSecondary",children:[u.categoria," - ",u.descripcion]}),(0,W.jsxs)(c.A,{variant:"body2",color:"textSecondary",children:["Stock disponible: ",null===(r=u.kilos)||void 0===r?void 0:r.toFixed(2)," kg / ",u.unidades," unidades"]}),(null===(a=u.proveedor)||void 0===a?void 0:a.nombre)&&(0,W.jsxs)(c.A,{variant:"body2",color:"textSecondary",children:["Proveedor: ",u.proveedor.nombre]}),u.partida&&(0,W.jsxs)(c.A,{variant:"body2",color:"textSecondary",children:["Partida: ",u.partida]})]})})]})}),(0,W.jsxs)(te.A,{children:[(0,W.jsx)(d.A,{onClick:S,color:"error",children:"Cancelar"}),(0,W.jsx)(d.A,{type:"submit",variant:"contained",color:"primary",disabled:p||j,children:p?(0,W.jsx)(ne.A,{size:20}):"Agregar al Remito"})]})]})]})};var ce=a(6223);const de="StockCard_card__92t7+",he="StockCard_expanded__W1OLa",pe="StockCard_cardHeader__RMG2I",ue="StockCard_title__RX0ic",me="StockCard_expandIndicator__nAbUv",ge="StockCard_details__M3OJy",xe="StockCard_itemsList__qmlVw",ve="StockCard_item__pKM1l",be="StockCard_itemTitle__lGvev",fe="StockCard_itemDetails__OMXFu",je="StockCard_moreItems__UNWXk",Ae=e=>{let{posicion:r,onClick:a,onAdicionRapida:i,onMovimientoInterno:n,onCorreccion:t,searchTerm:s="",children:c}=e;const[h,p]=(0,o.useState)(!1),u=(0,ce.uQ)(r),m=(0,o.useMemo)((()=>{if(!s.trim()||!r.items)return r.items||[];const e=s.toLowerCase().trim().split(/\s+/);return r.items.filter((r=>{var a;const o=[r.categoria||"",r.descripcion||"",r.partida||"",(null===(a=r.proveedor)||void 0===a?void 0:a.nombre)||""].join(" ").toLowerCase();return e.every((e=>o.includes(e)))}))}),[r.items,s]),g=(0,o.useMemo)((()=>m.reduce(((e,r)=>e+(r.kilos||0)),0)),[m]),x=(0,o.useMemo)((()=>m.reduce(((e,r)=>e+(r.unidades||0)),0)),[m]),v=e=>{e.stopPropagation(),null===a||void 0===a||a(r)},b=m.length>3;return s.trim()&&0===m.length?null:(0,W.jsxs)("div",{className:"".concat(de," ").concat(h?he:""),onClick:e=>{e.stopPropagation(),p(!h)},children:[(0,W.jsxs)("div",{className:pe,children:[(0,W.jsx)("h3",{className:ue,children:u}),b&&(0,W.jsx)("span",{className:me,children:h?"\u25bc":"\u25b6"})]}),(0,W.jsxs)("div",{className:ge,children:[(0,W.jsxs)("p",{children:[(0,W.jsx)("strong",{children:"Total Kilos:"})," ",g.toFixed(2)]}),(0,W.jsxs)("p",{children:[(0,W.jsx)("strong",{children:"Total Unidades:"})," ",x]}),(0,W.jsxs)("p",{children:[(0,W.jsx)("strong",{children:"Items:"})," ",m.length]}),(0,W.jsx)(l.A,{sx:{mt:2,mb:2,display:"none"},children:(0,W.jsx)(d.A,{variant:"contained",color:"success",size:"small",onClick:e=>{e.stopPropagation(),null===i||void 0===i||i(r)},sx:{width:"100%"},children:"+ Adici\xf3n R\xe1pida"})}),m.length>0&&(0,W.jsxs)("div",{className:xe,children:[(0,W.jsx)("p",{children:(0,W.jsx)("strong",{children:"Materiales:"})}),h?m.map(((e,a)=>{var o,i;return(0,W.jsxs)("div",{className:ve,onClick:v,children:[(0,W.jsxs)("p",{className:be,children:["\u2022 ",e.categoria," - ",e.descripcion]}),(0,W.jsxs)("div",{className:fe,children:[(0,W.jsxs)("span",{children:[(0,W.jsx)("strong",{children:"Partida:"})," ",e.partida]}),(0,W.jsxs)("span",{children:[(0,W.jsx)("strong",{children:"Kilos:"})," ",null===(o=e.kilos)||void 0===o?void 0:o.toFixed(2)]}),(0,W.jsxs)("span",{children:[(0,W.jsx)("strong",{children:"Unidades:"})," ",e.unidades]}),(null===(i=e.proveedor)||void 0===i?void 0:i.nombre)&&(0,W.jsxs)("span",{children:[(0,W.jsx)("strong",{children:"Proveedor:"})," ",e.proveedor.nombre]})]}),(0,W.jsxs)(l.A,{sx:{mt:1,display:"flex",gap:1},children:[(0,W.jsx)(d.A,{variant:"outlined",color:"primary",size:"small",onClick:a=>((e,a)=>{e.stopPropagation(),null===n||void 0===n||n(a,r)})(a,e),children:"Agregar al Remito"}),(0,W.jsx)(d.A,{variant:"outlined",color:"error",size:"small",onClick:a=>((e,a)=>{e.stopPropagation(),null===t||void 0===t||t(a,r)})(a,e),sx:{display:"none"},children:"Eliminar"})]})]},a)})):(0,W.jsxs)(W.Fragment,{children:[m.slice(0,3).map(((e,r)=>(0,W.jsxs)("p",{className:ve,children:["\u2022 ",e.categoria," - ",e.descripcion," (P: ",e.partida,")"]},r))),b&&(0,W.jsxs)("p",{className:je,children:["... y ",m.length-3," m\xe1s (click para expandir)"]})]})]})]})]})};function ye(e){var r,a;let{open:n,onClose:t,item:s,posicionId:h,onSubmit:p}=e;const u=(0,i.wA)(),m=(0,i.d4)((e=>{var r;return null===(r=e.remitos)||void 0===r?void 0:r.proveedores}))||[],g=m.filter((e=>{var r;return null===(r=e.categoria)||void 0===r?void 0:r.toLowerCase().includes("cliente")})),[x,v]=(0,o.useState)(""),[b,f]=(0,o.useState)(0),[j,A]=(0,o.useState)(0),[y,S]=(0,o.useState)("");(0,o.useEffect)((()=>{s&&(f(s.kilos||0),A(s.unidades||0))}),[s]),(0,o.useEffect)((()=>{!n||m&&0!==m.length||u((0,se.LC)())}),[n,u,m]);return(0,W.jsxs)(ee.A,{open:n,onClose:t,maxWidth:"sm",fullWidth:!0,children:[(0,W.jsx)(re.A,{children:"Agregar a Remito de Salida"}),(0,W.jsx)(ae.A,{children:0===m.length?(0,W.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",my:3},children:(0,W.jsx)(ne.A,{})}):(0,W.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[(0,W.jsx)(oe.A,{label:"Cliente",value:x,onChange:e=>{v(e.target.value)},select:!0,fullWidth:!0,required:!0,children:g.map((e=>(0,W.jsx)(ie.A,{value:e.id,children:e.nombre},e.id)))}),(0,W.jsxs)(c.A,{variant:"h6",component:"h6",children:["Kilos: ",b]}),(0,W.jsx)(oe.A,{label:"Unidades",type:"number",value:j,onChange:e=>{const r=parseInt(e.target.value)||0,a=Math.round(s.kilos/s.unidades*r);f(a),A(r)},fullWidth:!0,margin:"normal",inputProps:{min:0,max:(null===s||void 0===s?void 0:s.unidades)||0}}),(0,W.jsx)(oe.A,{fullWidth:!0,label:"Fecha",type:"date",value:y,onChange:e=>{S(e.target.value)},InputLabelProps:{shrink:!0}}),s&&(0,W.jsxs)(l.A,{sx:{p:2,bgcolor:"grey.50",borderRadius:1,border:"1px solid",borderColor:"grey.300"},children:[(0,W.jsx)(c.A,{variant:"subtitle2",gutterBottom:!0,children:"Material seleccionado:"}),(0,W.jsxs)(c.A,{variant:"body2",color:"textSecondary",children:[s.categoria," - ",s.descripcion]}),(0,W.jsxs)(c.A,{variant:"body2",color:"textSecondary",children:["Stock disponible: ",null===(r=s.kilos)||void 0===r?void 0:r.toFixed(2)," kg / ",s.unidades," unidades"]}),(null===(a=s.proveedor)||void 0===a?void 0:a.nombre)&&(0,W.jsxs)(c.A,{variant:"body2",color:"textSecondary",children:["Proveedor: ",s.proveedor.nombre]}),s.partida&&(0,W.jsxs)(c.A,{variant:"body2",color:"textSecondary",children:["Partida: ",s.partida]})]})]})}),(0,W.jsxs)(te.A,{children:[(0,W.jsx)(d.A,{onClick:t,children:"Cancelar"}),(0,W.jsx)(d.A,{onClick:()=>{if(!x||!y)return void alert("Por favor complete todos los campos requeridos");if(b>s.kilos||j>s.unidades)return void alert("No puede sacar m\xe1s mercader\xeda de la que hay disponible");if(b<=0||j<=0)return void alert("Los valores de kilos y unidades deben ser mayores a 0");const e={selectedItem:{itemId:s.itemId||s.id,categoria:s.categoria,descripcion:s.descripcion,proveedor:s.proveedor,partida:s.partida,kilos:s.kilos,unidades:s.unidades},kilos:parseFloat(b),unidades:parseInt(j),id:h,proveedor:x,fecha:y};p&&p(e),t()},variant:"contained",disabled:!(x&&y&&b>0&&j>0),children:"Agregar al Remito"})]})]})}var Se=a(3211),Ce=a(5655),ke=a(9156);a(4227);const Oe=()=>{const e=(0,i.wA)(),r=(0,n.A)(),a=(0,t.A)(r.breakpoints.down("sm")),j=(0,t.A)(r.breakpoints.down("md")),{user:A}=(()=>{const[e,r]=(0,o.useState)(null),[a,i]=(0,o.useState)(!0);return(0,o.useEffect)((()=>{const e=g.y.getUser();r(e),i(!1)}),[]),{user:e,isLoading:a,logout:()=>{g.y.logout(),window.location.href="/depositoDW_v2/"}}})(),[y,S]=(0,o.useState)([]),[C,k]=(0,o.useState)(""),[O,w]=(0,o.useState)({rack:"",fila:"",ab:"",pasillo:""}),[L,R]=(0,o.useState)(!1),[z,T]=(0,o.useState)(null),[I,_]=(0,o.useState)(null),[P,N]=(0,o.useState)(!1),M=(0,i.d4)(Ce.h4),E=(0,i.d4)(Ce.tN),B=(0,i.d4)(Ce.V6),H=(0,i.d4)((e=>e.salida.historial)),{loading:D,snackbar:F,handleSubmitSalida:ee,handleCloseSnackbar:re}=(()=>{const[e,r]=(0,o.useState)(!1),[a,i]=(0,o.useState)({open:!1,message:"",severity:"success"}),n=function(e){i({open:!0,message:e,severity:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"})};return{loading:e,snackbar:a,handleCrearSalida:async e=>{r(!0);try{console.log("Creando salida:",e),n(q,"success")}catch(B){console.error("Error al crear salida:",B),n(G,"error")}finally{r(!1)}},handleAprobarSalida:async e=>{r(!0);try{console.log("Aprobando salida:",e),n(U,"success")}catch(B){console.error("Error al aprobar salida:",B),n(X,"error")}finally{r(!1)}},handleRechazarSalida:async(e,a)=>{r(!0);try{console.log("Rechazando salida:",e,"Motivo:",a),n(K,"warning")}catch(B){console.error("Error al rechazar salida:",B),n(J,"error")}finally{r(!1)}},handleCompletarSalida:async e=>{r(!0);try{console.log("Completando salida:",e),n(Z,"success")}catch(B){console.error("Error al completar salida:",B),n(Q,"error")}finally{r(!1)}},handleCloseSnackbar:()=>{i((e=>({...e,open:!1})))}}})();(0,o.useEffect)((()=>{e((0,Se.LM)()),e((0,ke.O)())}),[e]),(0,o.useEffect)((()=>{const e=((e,r,a)=>{let o=e;if(r.trim()){const e=r.toLowerCase().trim().split(/\s+/);o=o.map((r=>{if(!r||!r.items)return null;const a=r.items.filter((r=>{var a;if(!r)return!1;const o=[r.categoria||"",r.descripcion||"",r.partida||"",(null===(a=r.proveedor)||void 0===a?void 0:a.nombre)||""].join(" ").toLowerCase();return e.every((e=>o.includes(e)))}));return a.length>0?{...r,items:a}:null})).filter((e=>null!==e))}return Object.values(a).some((e=>""!==e))&&(o=o.filter((e=>(!a.rack||e.rack===a.rack)&&(!a.fila||e.fila===a.fila)&&(!a.ab||e.AB===a.ab)&&(!a.pasillo||e.pasillo===a.pasillo)))),o})(M,C,O);S(e)}),[M,C,O]);const ae=e=>{console.log("Posici\xf3n seleccionada:",e)},oe=e=>{T(e),R(!0)},ie=(e,r)=>{console.log("Datos recibidos para movimiento interno:",{item:e,posicion:r}),e&&r?(_(e),T(r),R(!0)):console.error("Datos inv\xe1lidos para movimiento interno:",{item:e,posicion:r})},ne=(e,r)=>{_(e),T(r),R(!0)},te=()=>{g.y.logout(),window.location.href="/depositoDW_v2/login"};return A?E?(0,W.jsx)(b.A,{user:A,onLogout:te,pageTitle:"Salida",children:(0,W.jsx)(s.A,{maxWidth:"lg",sx:{py:a?2:4},children:(0,W.jsx)(l.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:(0,W.jsx)(c.A,{variant:"h6",sx:{color:"var(--color-text-secondary)",mb:2},children:"Cargando posiciones..."})})})}):B?(0,W.jsx)(b.A,{user:A,onLogout:te,pageTitle:"Salida",children:(0,W.jsx)(s.A,{maxWidth:"lg",sx:{py:a?2:4},children:(0,W.jsxs)(f.A,{title:"Error",subtitle:"No se pudieron cargar las posiciones",sx:{maxWidth:600,mx:"auto"},children:[(0,W.jsx)(c.A,{color:"error",sx:{mb:3},children:B}),(0,W.jsx)(d.A,{variant:"contained",onClick:()=>e((0,Se.LM)()),sx:{backgroundColor:"var(--color-primary)"},children:"Reintentar"})]})})}):(0,W.jsx)(b.A,{user:A,onLogout:te,pageTitle:"Salida",children:(0,W.jsxs)(s.A,{maxWidth:"lg",sx:{py:a?2:4},children:[!a&&(0,W.jsxs)(l.A,{sx:{mb:4},children:[(0,W.jsx)(c.A,{variant:"h3",sx:{fontWeight:700,color:"var(--color-text-primary)",mb:.5},children:"Salida"}),(0,W.jsx)(c.A,{variant:"body2",sx:{color:"var(--color-text-secondary)",mb:3},children:"Gesti\xf3n de salidas de materiales y remitos"})]}),(0,W.jsx)(f.A,{title:a?"Filtros":"B\xfasqueda y Filtros",subtitle:a?"":"Encuentra r\xe1pidamente los materiales para salida",sx:{mb:a?2:4},padding:a?"compact":"normal",children:(0,W.jsxs)(l.A,{sx:{display:"flex",flexDirection:"row",gap:a?.5:j?1:2,alignItems:"center",overflow:"hidden"},children:[(0,W.jsx)(l.A,{sx:{flex:a||j?"0 0 66.666%":"1",minWidth:0},children:(0,W.jsx)(x.I,{placeholder:"Buscar materiales por categor\xeda, descripci\xf3n, partida o proveedor...",onSearch:e=>{k(e)}})}),(0,W.jsx)(l.A,{sx:{flex:a||j?"0 0 33.333%":"0 0 auto",minWidth:a?"120px":j?"140px":"220px"},children:(0,W.jsx)(v.Y,{filters:O,onFilterChange:e=>{w(e)}})})]})}),(0,W.jsxs)(f.A,{title:a?void 0:"Gesti\xf3n de Salidas",subtitle:a?void 0:"Mostrando ".concat(y.length," posiciones con materiales"),padding:a?"compact":"normal",children:[(0,W.jsx)(V,{tabValue:0,onTabChange:(e,r)=>{},posicionesCount:y.length,historialCount:H.length}),(0,W.jsx)(l.A,{sx:{mt:2},children:0===y.length?(0,W.jsx)($,{icon:m.A,...Y.STOCK,searchTerm:C}):(0,W.jsx)(h.Ay,{container:!0,spacing:2,children:y.map((e=>(0,W.jsx)(h.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,W.jsx)(Ae,{posicion:e,onPosicionClick:ae,onAdicionRapida:oe,onMovimientoInterno:ie,onCorreccion:ne,searchTerm:C})},e.id)))})})]}),(0,W.jsx)(le,{open:L,onClose:()=>R(!1),posicion:z,item:I,onSubmit:ee}),(0,W.jsx)(ye,{open:P,onClose:()=>N(!1),onSubmit:async e=>{try{await ee(e),N(!1)}catch(B){console.error("Error al crear remito de salida:",B)}}}),(0,W.jsx)(p.A,{open:F.open,autoHideDuration:6e3,onClose:re,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,W.jsx)(u.A,{onClose:re,severity:F.severity,sx:{width:"100%"},children:F.message})})]})}):null}},5342:(e,r,a)=>{var o=a(4994);r.A=void 0;var i=o(a(39)),n=a(579);r.A=(0,i.default)((0,n.jsx)("path",{d:"M10.09 15.59 11.5 17l5-5-5-5-1.41 1.41L12.67 11H3v2h9.67zM19 3H5c-1.11 0-2 .9-2 2v4h2V5h14v14H5v-4H3v4c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2"}),"ExitToApp")},1958:(e,r,a)=>{var o=a(4994);r.A=void 0;var i=o(a(39)),n=a(579);r.A=(0,i.default)((0,n.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"}),"History")},8422:(e,r,a)=>{var o=a(4994);r.A=void 0;var i=o(a(39)),n=a(579);r.A=(0,i.default)((0,n.jsx)("path",{d:"M18 17H6v-2h12zm0-4H6v-2h12zm0-4H6V7h12zM3 22l1.5-1.5L6 22l1.5-1.5L9 22l1.5-1.5L12 22l1.5-1.5L15 22l1.5-1.5L18 22l1.5-1.5L21 22V2l-1.5 1.5L18 2l-1.5 1.5L15 2l-1.5 1.5L12 2l-1.5 1.5L9 2 7.5 3.5 6 2 4.5 3.5 3 2z"}),"Receipt")},7954:(e,r,a)=>{a.d(r,{A:()=>i});var o=a(5043);const i=e=>{const r=o.useRef({});return o.useEffect((()=>{r.current=e})),r.current}}}]);
//# sourceMappingURL=832.b2a644f9.chunk.js.map